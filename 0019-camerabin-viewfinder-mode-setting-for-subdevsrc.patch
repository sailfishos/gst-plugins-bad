From bc66b316889321b06cdff43150f9cd913f2a450c Mon Sep 17 00:00:00 2001
From: Hoseok Chang <hoseok.chang@nokia.com>
Date: Mon, 20 Sep 2010 14:33:50 +0300
Subject: [PATCH 19/23] camerabin: viewfinder-mode setting for subdevsrc

---
 gst/camerabin/gstcamerabin.c |   19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/gst/camerabin/gstcamerabin.c b/gst/camerabin/gstcamerabin.c
index 364d966..bc68818 100644
--- a/gst/camerabin/gstcamerabin.c
+++ b/gst/camerabin/gstcamerabin.c
@@ -671,6 +671,15 @@ camerabin_create_src_elements (GstCameraBin * camera)
     }
   }
 
+  /* Set "viewfinder-mode" for subdevsrc */
+  /* FIXME: subdevsrc specific */
+  if (camera->src_vid_src &&
+      g_object_class_find_property (G_OBJECT_GET_CLASS (camera->src_vid_src),
+          "viewfinder-mode")) {
+    g_object_set (G_OBJECT (camera->src_vid_src), "viewfinder-mode",
+        (camera->mode == MODE_IMAGE) ? 0 : 1, NULL);
+  }
+
   ret = TRUE;
 done:
   return ret;
@@ -1112,6 +1121,16 @@ gst_camerabin_change_mode (GstCameraBin * camera, gint mode)
       } else if (camera->mode == MODE_VIDEO) {
         camera->active_bin = camera->vidbin;
       }
+
+      /* Set "viewfinder-mode" for subdevsrc */
+      /* FIXME: subdevsrc specific */
+      if (camera->src_vid_src &&
+          g_object_class_find_property (G_OBJECT_GET_CLASS
+              (camera->src_vid_src), "viewfinder-mode")) {
+        g_object_set (G_OBJECT (camera->src_vid_src), "viewfinder-mode",
+            (camera->mode == MODE_IMAGE) ? 0 : 1, NULL);
+      }
+
       gst_camerabin_reset_to_view_finder (camera);
     } else if (camera->mode == MODE_IMAGE) {
       /* Prepare needed elements for image processing */
-- 
1.7.10.4

